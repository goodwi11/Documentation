Как разместить готовый вайт
===========================

Существует несколько способов, как можно разместить готовый вайт на хостинг. Каждый из них отличается сложностью и необходимыми для этого инструментами. Ниже вы можете ознакомиться с каждым из способов и выбрать для себя наиболее удобный.

Размещение вайта через панель управления хостингом
--------------------------------------------------

Наиболее простой способ — размещение вайта через панель управления хостингом. 
Для этого необходимо понять какая панель используется непосредственно у вас и следовать инструкциям ниже.

.. important::
 
 Перед размещением вайта на хостинг-панели убедитесь, что нужный вам домен привязан к хостингу.

**Размещение файлов вайта через ispmanager:**

1. Откройте панель управления хостингом.

2. Перейдите в раздел "**Сайты**" и выберите домен, на который вы хотите загрузить вайт, далее нажмите "**Файлы сайта**".

3. Обычно после добавления домена в панель управления хостингом в папке сайта (вайта) создаются файлы парковочной страницы. Удалите все файлы, содержащиеся в папке, кроме директории **webstat** (если она имеется), иначе установка вайта на хостинг можеть быть выполнена некорректно.

4. Нажмите кнопку "**Загрузить**". Выберите архив с вайтом на вашем устройстве и нажмите "**Ok**".

5. Выделите загруженный архив и через контекстное меню нажмите "**Извлечь**".

6. Убедитесь, что файлы вайта были извлечены непосредственно в каталог сайта, а не во вложенную директорию.

7. При необходимости переместите файлы вайта в корневой каталог, для этого выделите все файлы и воспользуйтесь кнопками "**Вырезать** и "**Вставить**".

8. Готово, если все выполнено правильно, то при переходе на ваш домен будет отображаться загруженный вайт.

**Размещение файлов вайта через Plesk:**

1. Откройте панель управления хостингом.

2. Перейдите в раздел «**Сайты и домены**» и откройте папку сайта.

3. Обычно после добавления домена в панель управления хостингом в папке сайта (вайта) создаются файлы парковочной страницы. Удалите все файлы, содержащиеся в папке, кроме директории **cgi-bin**, иначе установка вайта на хостинг можеть быть выполнена некорректно.

4. Нажмите кнопку "**Загрузить**". Выберите архив с вайтом на вашем устройстве и загрузите архив.

5. Выберите загруженный архив и нажмите на кнопку "**Извлечь файлы**".

6. Убедитесь, что файлы вайта были расположены непосредственно в каталоге сайта без дополнительных подкаталогов.

7. Если файлы были извлечены в подкаталог, переместите их в каталог сайта. Для этого перейдите в подкаталог, из которого необходимо переместить файлы, выберите нужные файлы и нажмите кнопку "**Переместить**". В появившемся окне выберите директорию сайта и нажмите кнопку "**OK**".

8. Готово, если все выполнено правильно, то при переходе на ваш домен будет отображаться загруженный вайт.

**Размещение файлов вайта через cPanel:**

1. Откройте панель управления хостингом.

2. В разделе «**Домены**» выберите пункт **Домены**.

3. Нажмите на корневую папку вашего сайта, чтобы перейти в корневой каталог.

4. Обычно после добавления домена в панель управления хостингом в папке сайта (вайта) создаются файлы парковочной страницы. Удалите все файлы, содержащиеся в папке, кроме директории **cgi-bin**, иначе установка вайта на хостинг можеть быть выполнена некорректно.

5. Нажмите кнопку "**Загрузить**".

6. Нажмите кнопку "**Выбрать файл**" или просто перетащите архив с вайтом, чтобы загрузить его.

7. Выделите загруженный архив и нажмите кнопку "**Извлечь**".

8. Введите путь до каталога (домена), в который нужно извлечь файлы. Затем нажмите кнопку "**Extract Files**".

9. Убедитесь, что файлы вайта были извлечены непосредственно в каталог сайта, а не во вложенную директорию.

10. Готово, если все выполнено правильно, то при переходе на ваш домен будет отображаться загруженный вайт.

Размещение вайта через FTP-клиент
---------------------------------

Доступ по FTP доступен для всех хостинг панелей. В данной инструкции мы рассмотрим подключение и размещение вайта через FTP-протокол на примере наиболее пополуряного FTP-клиента - FileZilla.

1. Для работы с данным протоколом необходимо `скачать <https://filezilla-project.org>`_ и установить клиент FileZilla.

2. Запустите клиент. В меню «**Файл**» перейдите в **Менеджер Сайтов...**.

3. В открывшимся окне нажмите на кнопку "**Новый Сайт**" и заполните следующие поля:

* | *Хост* - имя сервера хостинга, IP-адрес сервера хостинга или домен. Используйте домен, только если он привязан к хостингу;

* | *Порт* - можно не указывать или указать стандартный порт протокола FTP — 21;

* | *Протокол* - FTP-протокол передачи файлов;

* | *Шифрование* - использовать явный FTP через TLS, если доступен;

* | *Тип входа* - нормальный;

* | *Пользователь* - логин от вашего хостинга, например **exampleuser1234**;

* | *Пароль* - пароль от вашего хостинга, например **examplepassword1234**;

.. note::
 Данные для подключения вы можете найти на странице услуг вашего хостинга в личном кабинете или в настройках хостинга.

4. После этого, в том же окне перейдите во вкладку «**Настройки передачи**» и укажите следующие настройки:

* | *Режим передачи* - пассивный;

* | *Ограничение одновременных подключений* - поставьте галочку и укажите максимально доступное значение в поле «**Макс. число подключений**». При работе через FTP-протокол разные сервера имеют ограничения по одновременному количеству FTP-подключений с одного IP-адреса. Уточняйте значение у поставщика вашего хостинга.

5. После нажмите кнопку "**Соединиться**", для подключения к вашему хостингу.

.. note::
 Обычно при использовании VPS доступ предоставляется только к корневой директории. При необходимости вы можете настроить каталог подключения, чтобы при подключении по FTP-протоколу сразу открывалась необходимая директория. 
 Для этого перейдите во вкладку «**Дополнительно**» и в поле **Удаленный каталог по умолчанию** пропишите нужный путь до директории.

6. После подключения к хостингу вы увидите разделённое окно: слева — папка вашего локального устройства, справа — домашняя папка хостинга. Чтобы управлять папкой или файлом, кликните по нему правой кнопкой мыши.

7. В строке **Удаленный сайт** укажите путь до корневой папки где будет расположен вайт. В окне слева кликните правой кнопкой по папке с вайтом на вашем устройстве и выберите "**Закачать на сервер**".

8. Готово, если все выполнено правильно, то при переходе на ваш домен будет отображаться загруженный вайт.

Размещение вайта через сетевой протокол SSH
-------------------------------------------

Наиболее сложный способ — размещение вайта на сервер через сетевой протокол SSH (Secure SHell). 
Для этого необходимы базовые навыки работы с сервером, которые будут описаны ниже.

.. important::
 | Перед началом работы через SSH протокол убедитесь, что у вас есть доступ к серверу или хостингу через данный протокол. 
 | Вам понадобятся следущие данные: **ip**, **user** и **password**.

**Размещение файлов вайта на LINUX сервер с дистрибутивом Ubuntu, на веб-сервер Nginx:**

Установка веб-сервера NGINX:

1. Заходим на сервер через команду: ``ssh ip@user``

2. Получаем права **root** через команду: ``sudo -i``

3. Обновляем пакеты через команду: ``sudo apt update``

4. Устанавливаем Nginx через команду: ``sudo apt install nginx``

5. Проверяем статус Nginx через команду: ``systemctl status nginx``

6. Вы должны получить: **Active: active (running)**. Если статус не активный, то пропишите следующую команду: ``systemctl restart nginx``

7. Готово, Nginx установлен корректно и находится в активном состоянии.

Размещение вайта на сервер:

Самый простой и базовый способ размещения файлов — это Secure Copy Protocol, он же SSH File Transfer. 
Размещение статического сайта (вайта) всегда происходит в директорию **/var/www/**, через команду: ``scp -r ~/path/to/folder ip@user:/var/www/``

Конфигурация Nginx и домена:

.. important::
 Для отображения вашего вайта на домене необходимо задать свод правил для Nginx.
 Ваш актуальный домен должен быть привязан к текущему серверу при помощи DNS.

В инструкции ниже вам необходимо заменить ``domain.com`` на ваше доменное имя.

1. Необходимо перененести ваш вайт в следующую директорию: ``/var/www/domain.com``

2. Базовая конфигурация домена:
::
   server {
     server_name domain.com www.domain.com;

     location / {
       root /var/www/domain.com;
     }
   }

Вам необходимо записать эту конфигурацию по следующему пути: ``/etc/nginx/sites-available/domain.com``

.. note::
 Вы можете найти команды для взаимодействия с файловой системой сервера в таблице ниже.

3. Необходимо сделать symlink конфигурации через команду: ``ln -s /etc/nignx/sites-available/domain.com /etc/nginx/sites-enabled/``

4. Завершающим шагом перезапустите Nginx через команду: ``systemctl restart nginx``
 
**Команды для взаимодействия с файловой системой и редактированием файлов сервера.**

.. list-table:: Базовые команды Linux
   :header-rows: 1
   :stub-columns: 0

   * - Команда
     - Описание
   * - ``cd``
     - | Команда позволяющая перемещаться по директориям файловой системы.
       | Пример: ``cd /var/www``
   * - ``ls``
     - | Команда позволяющая просмотреть все имеющиеся папки и файлы в текущей директории.
   * - ``mkdir``
     - | Команда позволяющая создавать папки внутри директории.
       | Пример: ``mkdir new-folder``
   * - ``rm``
     - | Команда позволяющая удалять папки или файлы.
       | Пример удаления: ``rm file``
       | Пример удаления файлов внутри папки (рекурсивного): ``rm -rf folder``
   * - ``cp``
     - | Команда позволяющая копировать папки или файлы.
       | Пример копирования: ``cp file newfile``
       | Пример копирования файлов внутри папки (рекурсивного): ``cp -r folder new-folder``
   * - ``mv``
     - | Команда позволяющая перемещать папки или файлы.
       | Пример: ``mv folder new-folder``
   * - ``cat``
     - | Команда позволяющая считывать данные из файла. Данная команда позволяет записать файл из буфера обмена.
       | 1. Открыть запись в файл: ``cat >>file``
       | 2. Вставка текста из буфера обмена: сочетание клавиш **Ctrl + v** (WIN) или **Cmd + v** (MacOS)
       | 3. Закрытие записи: нажимаем 2 раза сочетание клавиш **Ctrl + d**


.. list-table:: Команды для текстового редактора Vim
   :header-rows: 1
   :stub-columns: 0

   * - Команда
     - Описание
   * - ``vim file``
     - | Команда позволяющая открыть или создать файл.
   * - ``i``
     - | Команда позволяющая перейти в режим взаимодействия.
   * - ``esc``
     - | Команда позволяющая выйти из любого режима.
   * - ``:w``
     - | Команда позволяющая сохранить файл.
   * - ``:wq``
     - | Команда позволяющая сохранить файл и выйти из него.
   * - ``:q``
     - | Команда позволяющая выйти из файла.

.. csv-table:: Команды для текстового редактора Nano
   :header: "Команда", "Описание"
   :widths: 15, 10, 30
   :header-rows: 1

   ``nano file``, Команда позволяющая открыть или создать файл.
   ``Ctrl + x``, | Команда позволяющая сохранить файл и выйти из него.
                 | Nano попросит вас подтвердить действие: выбираем ``y``
                 | Nano спросит имя файла: нажимаем **Enter**
   

.. list-table:: Команды для текстового редактора Nano
   :header-rows: 1
   :stub-columns: 0

   * - Команда
     - Описание
   * - ``nano file``
     - | Команда позволяющая открыть или создать файл.
   * - ``Ctrl + x``
     - | Команда позволяющая сохранить файл и выйти из него.
     - | Nano попросит вас подтвердить действие: выбираем ``y``
     - | Nano спросит имя файла: нажимаем **Enter**

**Возможные ошибки и их решения.**

Если при открытии домена вы видите белый экран или ошибку связанную с PHP, необходимо сделать следующее:

1. Проверить наличие PHP и PHP-FPM через следующие команды: ``php -v`` и ``php-fpm -v``

2. Если один из модулей отсутствует, то вы получите следующее: ``Command 'php' not found, but can be installed with:``

3. Необходимо установить недостающие модули:

| Установка PHP - ``sudo apt install php``

| Установка PHP-FPM (Fastcgi) - ``sudo apt install php-fpm``

4. Конфигурация домена с PHP-FPM:
:: 
   server {
     server_name domain.com www.domain.com;

     location / {
       root /var/www/domain.com;
       index index.php index.html;
     }

     # pass the PHP scripts to FastCGI server
     location ~ \.php$ {
       fastcgi_pass "unix:/var/run/php/php8.1-fpm.sock";
       fastcgi_index index.php;
       fastcgi_param  SCRIPT_FILENAME  /var/www/domain.com$fastcgi_script_name;
       include fastcgi_params;
     }
   }

Необходимо записать данную конфигурацию в следующую директорию: ``/etc/nginx/sites-available/domain.com``

5. Необходимо сделать symlink конфигурации через команду: ``ln -s /etc/nignx/sites-available/domain.com /etc/nginx/sites-enabled/``

6. Последним шагом необходимо перезапустить Nginx: ``systemctl reload nginx``
